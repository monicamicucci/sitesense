flowchart TD
    A["ğŸ“¥ Ricevi Lista AttivitÃ <br/>nome, categoria, prezzo, rating, recensioni, servizi, tag, distanza"] --> B["ğŸ” Analizza Richiesta Utente"]
    
    B --> C{"Preferenze Specificate?"}
    
    C -->|NO| D["ğŸš« Escludi Rating minore 3.8<br/>salvo unica opzione"]
    C -->|SI| E{"Tipo di Preferenza"}
    
    E -->|Budget| F{"Fascia Budget"}
    E -->|Requisiti Specifici| G["ğŸ¯ Filtra per Servizi<br/>family, pet-friendly, accessibilita"]
    E -->|Prodotti Tipici| H["ğŸ½ï¸ Filtra per Tag Prodotti"]
    
    F -->|Economico| I["ğŸ’° Filtra Fascia 1-2â‚¬"]
    F -->|Medio| J["ğŸ’³ Filtra Fascia 2â‚¬<br/>Rating sopra media"]
    F -->|Lusso| K["ğŸ’ Filtra Fascia 3-4â‚¬<br/>Servizi premium"]
    
    G --> L{"Risultati Trovati?"}
    H --> M{"Prodotti Disponibili?"}
    
    L -->|SI| N["âœ… Mantieni Filtrati"]
    L -->|NO| O["âš ï¸ Nessuna attivita rispetta criteri<br/>Usa migliori alternative"]
    
    M -->|SI| P["âœ… Mantieni con Prodotti"]
    M -->|NO| Q["âš ï¸ Prodotti non disponibili<br/>Usa alternative piu votate"]
    
    I --> R["ğŸš« Escludi Rating minore 3.8<br/>salvo unica opzione"]
    J --> R
    K --> R
    N --> R
    O --> R
    P --> R
    Q --> R
    D --> R
    
    R --> S["ğŸ“Š Calcola Punteggio Qualita<br/>rating Ã— log10(recensioni + 1)"]
    
    S --> T["ğŸ’¯ Calcola Rapporto Qualita-Prezzo<br/>rating / fascia prezzo"]
    
    T --> U["ğŸ“ Calcola Peso Distanza<br/>se disponibile"]
    
    U --> V["ğŸ“ˆ Ordinamento Multi-Criterio<br/>1. Punteggio qualita<br/>2. Rapporto qualita-prezzo<br/>3. Numero recensioni<br/>4. Distanza"]
    
    V --> W["ğŸ”¢ Seleziona 3-5 Attivita<br/>per categoria<br/>tutte se minore 3"]
    
    W --> X["ğŸ¨ Formatta Output HTML<br/>nome, prezzo, rating, servizi<br/>descrizione max 20 parole<br/>link Maps/sito"]
    
    X --> Y["âœ… Output Finale"]
    
    style A fill:#e1f5fe
    style Y fill:#c8e6c9
    style O fill:#ffecb3
    style Q fill:#ffecb3
    style C fill:#f3e5f5
    style E fill:#f3e5f5
    style F fill:#f3e5f5
    style L fill:#f3e5f5
    style M fill:#f3e5f5
    style S fill:#e8f5e8
    style T fill:#e8f5e8
    style U fill:#e8f5e8